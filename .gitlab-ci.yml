image: "python:3.9"

before_script:
  - python --version
  - pip install -r requirements.txt

stages:
  - Static Analysis
  - Unit Tests

flake8:
  stage: Static Analysis
  tags:
    - docker
  script:
    - flake8 .
  only:
    - merge_requests

yapf:
  stage: Static Analysis
  tags:
    - docker
  script:
    - if [ `yapf -r ./ -d | wc -l` -gt 0 ] ; then false ; else true ;fi
  only:
    - merge_requests

unittests:
  stage: Unit Tests
  tags:
    - docker
  script:
    - SDL_VIDEODRIVER="dummy" python -m unittest discover -s src -t .. -p "test_*.py"
  only:
    - merge_requests
